### 2. κ·Έλλ””μ–ΈνΈ λ„μ (Gradient Accumulation) ###

  * μ „μ²΄ λ°°μΉμ— λ€ν• κ·Έλλ””μ–ΈνΈλ¥Ό ν• λ²μ— κ³„μ‚°ν•λ” λ€μ‹ , λ” μ‘μ€ λ‹¨μ„λ΅ μ μ§„μ μΌλ΅ κ³„μ‚°ν•λ” λ°©μ‹
  * μ΄ μ ‘κ·Όλ²•μ—μ„λ” λ¨λΈμ„ ν†µν•΄ **μμ „ν(forward pass) λ° μ—­μ „ν(backward pass)** λ¥Ό λ°λ³µμ μΌλ΅ μν–‰ν•λ©΄μ„ κ·Έλλ””μ–ΈνΈλ¥Ό λ„μ ν•λ‹¤.
  * μΌμ • νμλ§νΌ κ·Έλλ””μ–ΈνΈκ°€ λ„μ λλ©΄, κ·Έμ μ„μ•Ό λ¨λΈμ μµμ ν™”(optimization) λ‹¨κ³„κ°€ μ‹¤ν–‰
  * κ·Έλλ””μ–ΈνΈ λ„μ μ„ ν™μ©ν•λ©΄ **GPU λ©”λ¨λ¦¬ ν•κ³„λ¥Ό μ΄κ³Όν•μ§€ μ•μΌλ©΄μ„λ„ λ” ν° ν¨κ³Όμ μΈ λ°°μΉ ν¬κΈ°(effective batch size)λ¥Ό μ‚¬μ©ν•  μ μκ² λλ‹¤**. 
  * κ·Έλ¬λ‚ κ·Έλλ””μ–ΈνΈ λ„μ  κ³Όμ •μ—μ„ **μ¶”κ°€μ μΈ μμ „ν λ° μ—­μ „ν μ—°μ‚°μ΄ λ°μƒν•λ―€λ΅ ν›λ ¨ μ†λ„κ°€ λλ ¤μ§ μ μμ**μ„ μ μν•΄μ•Ό ν•λ‹¤. 
  * κ·Έλλ””μ–ΈνΈ λ„μ μ„ ν™μ„±ν™”ν•λ ¤λ©΄ `TrainingArguments`μ— `gradient_accumulation_steps` μΈμλ¥Ό μ¶”κ°€ν•λ©΄ λλ‹¤. 

```
training_args = TrainingArguments(per_device_train_batch_size=1, gradient_accumulation_steps=4, **default_args)
```

μ„ μμ μ—μ„ μ‹¤μ  λ°°μΉ ν¬κΈ°(effective batch size) λ” 4κ°€ λλ‹¤. λν•, ν›λ ¨ λ£¨ν”„μ— λ€ν• μ™„μ „ν• μ μ–΄(full control) λ¥Ό μ›ν•λ‹¤λ©΄ [π¤— Accelerateλ¥Ό](https://huggingface.co/docs/transformers/v4.48.2/en/perf_train_gpu_one#using--accelerate) ν™μ©ν•  μλ„ μλ‹¤. 

GPU μ‚¬μ©λ¥ μ„ μµλ€ν• ν™μ©ν•λ” κ²ƒμ΄ κ¶μ¥λμ§€λ§, λ„λ¬΄ λ§μ€ κ·Έλλ””μ–ΈνΈ λ„μ  λ‹¨κ³„(gradient accumulation steps)κ°€ μ„¤μ •λλ©΄ ν›λ ¨ μ†λ„κ°€ λ”μ± λλ ¤μ§ μ μμμ„ μ μν•΄μ•Ό ν•λ‹¤. 

μλ¥Ό λ“¤μ–΄, per_device_train_batch_size=4κ°€ GPU λ©”λ¨λ¦¬ ν•κ³„μ— λ„λ‹¬ν–λ‹¤κ³  κ°€μ •ν•΄ λ³΄μ. λ§μ•½ λ°°μΉ ν¬κΈ° 64λ΅ ν›λ ¨ν•κ³  μ‹¶λ‹¤λ©΄, per_device_train_batch_size=1κ³Ό gradient_accumulation_steps=64λ΅ μ„¤μ •ν•λ” κ²ƒμ€ λΉ„ν¨μ¨μ μ΄λ‹¤. 

λλ”, `per_device_train_batch_size=4`λ΅ μ μ§€ν•κ³ , `gradient_accumulation_steps=16`μΌλ΅ μ„¤μ •ν•λ©΄, λ™μΌν• ν¨κ³Όμ μΈ λ°°μΉ ν¬κΈ°(effective batch size) λ¥Ό μ μ§€ν•λ©΄μ„λ„ GPU λ¦¬μ†μ¤λ¥Ό λ” ν¨μ¨μ μΌλ΅ ν™μ©ν•  μ μλ‹¤. μ¶”κ°€ μ •λ³΄λ” RTX-3090 λ° A100μ—μ„μ λ°°μΉ ν¬κΈ° λ° κ·Έλλ””μ–ΈνΈ λ„μ  λ²¤μΉλ§ν¬λ¥Ό μ°Έκ³ ν•λΌ. 

